generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum SchoolLevel {
  VMBO
  VMBO_T
  VMBO_B
  VMBO_K
  HAVO
  VWO
}

model School {
  id          String        @id @default(cuid())
  brin        String?       @unique
  name        String
  websiteUrl  String?
  phone       String?

  street      String?
  houseNumber String?
  postalCode  String?
  city        String?       @default("Amsterdam")

  lat         Float?
  lon         Float?

  levels      SchoolLevel[]
  concepts    String[]      // e.g. Montessori, Jenaplan, Dalton
  denomination String?      // e.g. openbaar, bijzonder, etc.

  size        Int?          // approximate student count
  results     Json?         // DUO/other metrics (prototype)
  admissions  Json?         // lottery/admissions notes (prototype)

  source      String?       // which dataset populated this record
  sourceUrl   String?
  updatedAt   DateTime      @updatedAt
  createdAt   DateTime      @default(now())

  @@index([name])
  @@index([postalCode])
}

model Favorite {
  id        String   @id @default(cuid())
  profileId String
  schoolId  String
  rank      Int
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([profileId, schoolId])
  @@index([profileId, rank])
}

model SchoolNote {
  id        String   @id @default(cuid())
  profileId String
  schoolId  String
  note      String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([profileId, schoolId])
  @@index([profileId])
}
